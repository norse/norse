
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>6. Parameter learning in Spiking Neural Networks &#8212; Norse v0.0.7</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.1/dist/embed-amd.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="7. Hardware acceleration" href="hardware.html" />
    <link rel="prev" title="5. Running Tasks" href="tasks.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Norse v0.0.7</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../index.html">
                    Getting started
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  First steps
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="installing.html">
   1. Installing Norse
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="started.html">
   2. Quickstart
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="working.html">
   3. Working with Norse
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Usage docs
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="spiking.html">
   4. Introduction to spiking systems
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="tasks.html">
   5. Running Tasks
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   6. Parameter learning in Spiking Neural Networks
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="hardware.html">
   7. Hardware acceleration
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="papers.html">
   8. Papers citing Norse
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="about.html">
   9. About Norse
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Development docs
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="development.html">
   10. Development Documentation
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Python API
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../norse.torch.html">
   norse.torch
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../generated/norse.torch.module.Lift.html">
     norse.torch.module.Lift
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../generated/norse.torch.module.SequentialState.html">
     norse.torch.module.SequentialState
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../generated/norse.torch.module.RegularizationCell.html">
     norse.torch.module.RegularizationCell
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../generated/norse.torch.module.encode.ConstantCurrentLIFEncoder.html">
     norse.torch.module.encode.ConstantCurrentLIFEncoder
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../generated/norse.torch.module.encode.PoissonEncoder.html">
     norse.torch.module.encode.PoissonEncoder
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../generated/norse.torch.module.encode.PoissonEncoderStep.html">
     norse.torch.module.encode.PoissonEncoderStep
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../generated/norse.torch.module.encode.PopulationEncoder.html">
     norse.torch.module.encode.PopulationEncoder
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../generated/norse.torch.module.encode.SignedPoissonEncoder.html">
     norse.torch.module.encode.SignedPoissonEncoder
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../generated/norse.torch.module.encode.SpikeLatencyEncoder.html">
     norse.torch.module.encode.SpikeLatencyEncoder
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../generated/norse.torch.module.encode.SpikeLatencyLIFEncoder.html">
     norse.torch.module.encode.SpikeLatencyLIFEncoder
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../generated/norse.torch.module.conv.LConv2d.html">
     norse.torch.module.conv.LConv2d
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../generated/norse.torch.module.iaf.IAFFeedForwardState.html">
     norse.torch.module.iaf.IAFFeedForwardState
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../generated/norse.torch.module.iaf.IAFParameters.html">
     norse.torch.module.iaf.IAFParameters
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../generated/norse.torch.module.iaf.IAFCell.html">
     norse.torch.module.iaf.IAFCell
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../generated/norse.torch.module.izhikevich.IzhikevichState.html">
     norse.torch.module.izhikevich.IzhikevichState
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../generated/norse.torch.module.izhikevich.IzhikevichSpikingBehavior.html">
     norse.torch.module.izhikevich.IzhikevichSpikingBehavior
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../generated/norse.torch.module.izhikevich.Izhikevich.html">
     norse.torch.module.izhikevich.Izhikevich
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../generated/norse.torch.module.izhikevich.IzhikevichCell.html">
     norse.torch.module.izhikevich.IzhikevichCell
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../generated/norse.torch.module.izhikevich.IzhikevichRecurrent.html">
     norse.torch.module.izhikevich.IzhikevichRecurrent
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../generated/norse.torch.module.izhikevich.IzhikevichRecurrentCell.html">
     norse.torch.module.izhikevich.IzhikevichRecurrentCell
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../generated/norse.torch.module.leaky_integrator.LIState.html">
     norse.torch.module.leaky_integrator.LIState
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../generated/norse.torch.module.leaky_integrator.LIParameters.html">
     norse.torch.module.leaky_integrator.LIParameters
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../generated/norse.torch.module.leaky_integrator.LI.html">
     norse.torch.module.leaky_integrator.LI
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../generated/norse.torch.module.leaky_integrator.LICell.html">
     norse.torch.module.leaky_integrator.LICell
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../generated/norse.torch.module.leaky_integrator.LILinearCell.html">
     norse.torch.module.leaky_integrator.LILinearCell
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../generated/norse.torch.LIFParameters.html">
     norse.torch.LIFParameters
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../generated/norse.torch.LIFState.html">
     norse.torch.LIFState
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../generated/norse.torch.LIF.html">
     norse.torch.LIF
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../generated/norse.torch.LIFCell.html">
     norse.torch.LIFCell
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../generated/norse.torch.LIFRecurrent.html">
     norse.torch.LIFRecurrent
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../generated/norse.torch.LIFRecurrentCell.html">
     norse.torch.LIFRecurrentCell
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../generated/norse.torch.module.lif_box.LIFBoxFeedForwardState.html">
     norse.torch.module.lif_box.LIFBoxFeedForwardState
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../generated/norse.torch.module.lif_box.LIFBoxParameters.html">
     norse.torch.module.lif_box.LIFBoxParameters
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../generated/norse.torch.module.lif_box.LIFBoxCell.html">
     norse.torch.module.lif_box.LIFBoxCell
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../generated/norse.torch.module.coba_lif.CobaLIFCell.html">
     norse.torch.module.coba_lif.CobaLIFCell
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../generated/norse.torch.module.lif_adex.LIFAdEx.html">
     norse.torch.module.lif_adex.LIFAdEx
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../generated/norse.torch.module.lif_adex.LIFAdExCell.html">
     norse.torch.module.lif_adex.LIFAdExCell
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../generated/norse.torch.module.lif_adex.LIFAdExRecurrent.html">
     norse.torch.module.lif_adex.LIFAdExRecurrent
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../generated/norse.torch.module.lif_adex.LIFAdExRecurrentCell.html">
     norse.torch.module.lif_adex.LIFAdExRecurrentCell
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../generated/norse.torch.module.lif_ex.LIFEx.html">
     norse.torch.module.lif_ex.LIFEx
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../generated/norse.torch.module.lif_ex.LIFExCell.html">
     norse.torch.module.lif_ex.LIFExCell
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../generated/norse.torch.module.lif_ex.LIFExRecurrent.html">
     norse.torch.module.lif_ex.LIFExRecurrent
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../generated/norse.torch.module.lif_ex.LIFExRecurrentCell.html">
     norse.torch.module.lif_ex.LIFExRecurrentCell
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../generated/norse.torch.module.lif_mc.LIFMCRecurrentCell.html">
     norse.torch.module.lif_mc.LIFMCRecurrentCell
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../generated/norse.torch.module.lif_mc_refrac.LIFMCRefracRecurrentCell.html">
     norse.torch.module.lif_mc_refrac.LIFMCRefracRecurrentCell
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../generated/norse.torch.module.lif_refrac.LIFRefracCell.html">
     norse.torch.module.lif_refrac.LIFRefracCell
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../generated/norse.torch.module.lif_refrac.LIFRefracRecurrentCell.html">
     norse.torch.module.lif_refrac.LIFRefracRecurrentCell
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../generated/norse.torch.module.lsnn.LSNN.html">
     norse.torch.module.lsnn.LSNN
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../generated/norse.torch.module.lsnn.LSNNCell.html">
     norse.torch.module.lsnn.LSNNCell
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../generated/norse.torch.module.lsnn.LSNNRecurrent.html">
     norse.torch.module.lsnn.LSNNRecurrent
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../generated/norse.torch.module.lsnn.LSNNRecurrentCell.html">
     norse.torch.module.lsnn.LSNNRecurrentCell
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../norse.torch.functional.html">
   norse.torch.functional
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../generated/norse.torch.functional.constant_current_lif_encode.html">
     norse.torch.functional.constant_current_lif_encode
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../generated/norse.torch.functional.gaussian_rbf.html">
     norse.torch.functional.gaussian_rbf
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../generated/norse.torch.functional.euclidean_distance.html">
     norse.torch.functional.euclidean_distance
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../generated/norse.torch.functional.population_encode.html">
     norse.torch.functional.population_encode
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../generated/norse.torch.functional.poisson_encode.html">
     norse.torch.functional.poisson_encode
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../generated/norse.torch.functional.poisson_encode_step.html">
     norse.torch.functional.poisson_encode_step
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../generated/norse.torch.functional.signed_poisson_encode.html">
     norse.torch.functional.signed_poisson_encode
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../generated/norse.torch.functional.signed_poisson_encode_step.html">
     norse.torch.functional.signed_poisson_encode_step
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../generated/norse.torch.functional.spike_latency_lif_encode.html">
     norse.torch.functional.spike_latency_lif_encode
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../generated/norse.torch.functional.spike_latency_encode.html">
     norse.torch.functional.spike_latency_encode
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../generated/norse.torch.functional.lif_current_encoder.html">
     norse.torch.functional.lif_current_encoder
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../generated/norse.torch.functional.lif_adex_current_encoder.html">
     norse.torch.functional.lif_adex_current_encoder
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../generated/norse.torch.functional.lif_ex_current_encoder.html">
     norse.torch.functional.lif_ex_current_encoder
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../generated/norse.torch.functional.logical.logical_and.html">
     norse.torch.functional.logical.logical_and
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../generated/norse.torch.functional.logical.logical_xor.html">
     norse.torch.functional.logical.logical_xor
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../generated/norse.torch.functional.logical.logical_or.html">
     norse.torch.functional.logical.logical_or
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../generated/norse.torch.functional.logical.muller_c.html">
     norse.torch.functional.logical.muller_c
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../generated/norse.torch.functional.logical.posedge_detector.html">
     norse.torch.functional.logical.posedge_detector
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../generated/norse.torch.functional.regularization.regularize_step.html">
     norse.torch.functional.regularization.regularize_step
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../generated/norse.torch.functional.regularization.spike_accumulator.html">
     norse.torch.functional.regularization.spike_accumulator
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../generated/norse.torch.functional.regularization.voltage_accumulator.html">
     norse.torch.functional.regularization.voltage_accumulator
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../generated/norse.torch.functional.heaviside.html">
     norse.torch.functional.heaviside
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../generated/norse.torch.functional.heavi_erfc_fn.html">
     norse.torch.functional.heavi_erfc_fn
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../generated/norse.torch.functional.heavi_tanh_fn.html">
     norse.torch.functional.heavi_tanh_fn
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../generated/norse.torch.functional.logistic_fn.html">
     norse.torch.functional.logistic_fn
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../generated/norse.torch.functional.heavi_circ_fn.html">
     norse.torch.functional.heavi_circ_fn
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../generated/norse.torch.functional.circ_dist_fn.html">
     norse.torch.functional.circ_dist_fn
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../generated/norse.torch.functional.triangle_fn.html">
     norse.torch.functional.triangle_fn
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../generated/norse.torch.functional.super_fn.html">
     norse.torch.functional.super_fn
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../generated/norse.torch.functional.lift.html">
     norse.torch.functional.lift
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../generated/norse.torch.functional.iaf.IAFParameters.html">
     norse.torch.functional.iaf.IAFParameters
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../generated/norse.torch.functional.iaf.IAFFeedForwardState.html">
     norse.torch.functional.iaf.IAFFeedForwardState
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../generated/norse.torch.functional.iaf.iaf_feed_forward_step.html">
     norse.torch.functional.iaf.iaf_feed_forward_step
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../generated/norse.torch.functional.izhikevich.IzhikevichParameters.html">
     norse.torch.functional.izhikevich.IzhikevichParameters
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../generated/norse.torch.functional.izhikevich.IzhikevichSpikingBehavior.html">
     norse.torch.functional.izhikevich.IzhikevichSpikingBehavior
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../generated/norse.torch.functional.izhikevich.tonic_spiking.html">
     norse.torch.functional.izhikevich.tonic_spiking
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../generated/norse.torch.functional.izhikevich.tonic_bursting.html">
     norse.torch.functional.izhikevich.tonic_bursting
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../generated/norse.torch.functional.izhikevich.phasic_spiking.html">
     norse.torch.functional.izhikevich.phasic_spiking
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../generated/norse.torch.functional.izhikevich.phasic_bursting.html">
     norse.torch.functional.izhikevich.phasic_bursting
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../generated/norse.torch.functional.izhikevich.mixed_mode.html">
     norse.torch.functional.izhikevich.mixed_mode
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../generated/norse.torch.functional.izhikevich.spike_frequency_adaptation.html">
     norse.torch.functional.izhikevich.spike_frequency_adaptation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../generated/norse.torch.functional.izhikevich.class_1_exc.html">
     norse.torch.functional.izhikevich.class_1_exc
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../generated/norse.torch.functional.izhikevich.class_2_exc.html">
     norse.torch.functional.izhikevich.class_2_exc
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../generated/norse.torch.functional.izhikevich.spike_latency.html">
     norse.torch.functional.izhikevich.spike_latency
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../generated/norse.torch.functional.izhikevich.subthreshold_oscillation.html">
     norse.torch.functional.izhikevich.subthreshold_oscillation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../generated/norse.torch.functional.izhikevich.resonator.html">
     norse.torch.functional.izhikevich.resonator
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../generated/norse.torch.functional.izhikevich.izhikevich_feed_forward_step.html">
     norse.torch.functional.izhikevich.izhikevich_feed_forward_step
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../generated/norse.torch.functional.leaky_integrator.LIParameters.html">
     norse.torch.functional.leaky_integrator.LIParameters
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../generated/norse.torch.functional.leaky_integrator.LIState.html">
     norse.torch.functional.leaky_integrator.LIState
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../generated/norse.torch.functional.leaky_integrator.li_feed_forward_step.html">
     norse.torch.functional.leaky_integrator.li_feed_forward_step
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../generated/norse.torch.functional.LIFParameters.html">
     norse.torch.functional.LIFParameters
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../generated/norse.torch.functional.LIFFeedForwardState.html">
     norse.torch.functional.LIFFeedForwardState
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../generated/norse.torch.functional.lif_feed_forward_step.html">
     norse.torch.functional.lif_feed_forward_step
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../generated/norse.torch.functional.lif_feed_forward_adjoint_step.html">
     norse.torch.functional.lif_feed_forward_adjoint_step
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../generated/norse.torch.functional.lif_feed_forward_adjoint_step_sparse.html">
     norse.torch.functional.lif_feed_forward_adjoint_step_sparse
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../generated/norse.torch.functional.lif_box.LIFBoxFeedForwardState.html">
     norse.torch.functional.lif_box.LIFBoxFeedForwardState
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../generated/norse.torch.functional.lif_box.LIFBoxParameters.html">
     norse.torch.functional.lif_box.LIFBoxParameters
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../generated/norse.torch.functional.lif_box.lif_box_feed_forward_step.html">
     norse.torch.functional.lif_box.lif_box_feed_forward_step
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../generated/norse.torch.functional.coba_lif.CobaLIFParameters.html">
     norse.torch.functional.coba_lif.CobaLIFParameters
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../generated/norse.torch.functional.coba_lif.CobaLIFFeedForwardState.html">
     norse.torch.functional.coba_lif.CobaLIFFeedForwardState
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../generated/norse.torch.functional.coba_lif.coba_lif_feed_forward_step.html">
     norse.torch.functional.coba_lif.coba_lif_feed_forward_step
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../generated/norse.torch.functional.lif_adex.LIFAdExParameters.html">
     norse.torch.functional.lif_adex.LIFAdExParameters
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../generated/norse.torch.functional.lif_adex.LIFAdExFeedForwardState.html">
     norse.torch.functional.lif_adex.LIFAdExFeedForwardState
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../generated/norse.torch.functional.lif_adex.lif_adex_feed_forward_step.html">
     norse.torch.functional.lif_adex.lif_adex_feed_forward_step
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../generated/norse.torch.functional.lif_adex.lif_adex_current_encoder.html">
     norse.torch.functional.lif_adex.lif_adex_current_encoder
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../generated/norse.torch.functional.lif_ex.LIFExParameters.html">
     norse.torch.functional.lif_ex.LIFExParameters
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../generated/norse.torch.functional.lif_ex.LIFExFeedForwardState.html">
     norse.torch.functional.lif_ex.LIFExFeedForwardState
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../generated/norse.torch.functional.lif_ex.lif_ex_feed_forward_step.html">
     norse.torch.functional.lif_ex.lif_ex_feed_forward_step
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../generated/norse.torch.functional.lif_ex.lif_ex_current_encoder.html">
     norse.torch.functional.lif_ex.lif_ex_current_encoder
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../generated/norse.torch.functional.lif_mc_feed_forward_step.html">
     norse.torch.functional.lif_mc_feed_forward_step
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../generated/norse.torch.functional.lif_mc_refrac_feed_forward_step.html">
     norse.torch.functional.lif_mc_refrac_feed_forward_step
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../generated/norse.torch.functional.LIFRefracParameters.html">
     norse.torch.functional.LIFRefracParameters
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../generated/norse.torch.functional.LIFRefracFeedForwardState.html">
     norse.torch.functional.LIFRefracFeedForwardState
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../generated/norse.torch.functional.lif_refrac_feed_forward_step.html">
     norse.torch.functional.lif_refrac_feed_forward_step
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../generated/norse.torch.functional.lif_refrac_feed_forward_adjoint_step.html">
     norse.torch.functional.lif_refrac_feed_forward_adjoint_step
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../generated/norse.torch.functional.LSNNParameters.html">
     norse.torch.functional.LSNNParameters
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../generated/norse.torch.functional.LSNNFeedForwardState.html">
     norse.torch.functional.LSNNFeedForwardState
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../generated/norse.torch.functional.lsnn_feed_forward_step.html">
     norse.torch.functional.lsnn_feed_forward_step
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../generated/norse.torch.functional.lsnn_feed_forward_adjoint_step.html">
     norse.torch.functional.lsnn_feed_forward_adjoint_step
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../generated/norse.torch.functional.STDPSensorParameters.html">
     norse.torch.functional.STDPSensorParameters
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../generated/norse.torch.functional.STDPSensorState.html">
     norse.torch.functional.STDPSensorState
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../generated/norse.torch.functional.stdp_sensor_step.html">
     norse.torch.functional.stdp_sensor_step
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../generated/norse.torch.functional.TsodyksMakramParameters.html">
     norse.torch.functional.TsodyksMakramParameters
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../generated/norse.torch.functional.TsodyksMakramState.html">
     norse.torch.functional.TsodyksMakramState
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../generated/norse.torch.functional.stp_step.html">
     norse.torch.functional.stp_step
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../norse.torch.utils.html">
   norse.torch.utils
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../generated/norse.torch.utils.plot.plot_heatmap_2d.html">
     norse.torch.utils.plot.plot_heatmap_2d
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../generated/norse.torch.utils.plot.plot_heatmap_3d.html">
     norse.torch.utils.plot.plot_heatmap_3d
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../generated/norse.torch.utils.plot.plot_histogram_2d.html">
     norse.torch.utils.plot.plot_histogram_2d
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../generated/norse.torch.utils.plot.plot_izhikevich.html">
     norse.torch.utils.plot.plot_izhikevich
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../generated/norse.torch.utils.plot.plot_neuron_states.html">
     norse.torch.utils.plot.plot_neuron_states
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../generated/norse.torch.utils.plot.plot_scatter_3d.html">
     norse.torch.utils.plot.plot_scatter_3d
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../generated/norse.torch.utils.plot.plot_spikes_2d.html">
     norse.torch.utils.plot.plot_spikes_2d
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../generated/norse.torch.utils.tensorboard.hook_spike_activity_mean.html">
     norse.torch.utils.tensorboard.hook_spike_activity_mean
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../generated/norse.torch.utils.tensorboard.hook_spike_activity_sum.html">
     norse.torch.utils.tensorboard.hook_spike_activity_sum
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../generated/norse.torch.utils.tensorboard.hook_spike_histogram_mean.html">
     norse.torch.utils.tensorboard.hook_spike_histogram_mean
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../generated/norse.torch.utils.tensorboard.hook_spike_histogram_sum.html">
     norse.torch.utils.tensorboard.hook_spike_histogram_sum
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../generated/norse.torch.utils.tensorboard.hook_spike_image.html">
     norse.torch.utils.tensorboard.hook_spike_image
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../api.html">
   Complete API
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../generated/norse.html">
     norse
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
    <label for="toctree-checkbox-5">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="../generated/norse.benchmark.html">
       norse.benchmark
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
      <label for="toctree-checkbox-6">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="../generated/norse.benchmark.benchmark.html">
         norse.benchmark.benchmark
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../generated/norse.benchmark.norse_lif.html">
         norse.benchmark.norse_lif
        </a>
       </li>
      </ul>
     </li>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="../generated/norse.dataset.html">
       norse.dataset
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
      <label for="toctree-checkbox-7">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="../generated/norse.dataset.memory.html">
         norse.dataset.memory
        </a>
       </li>
      </ul>
     </li>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="../generated/norse.task.html">
       norse.task
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
      <label for="toctree-checkbox-8">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="../generated/norse.task.correlation_experiment.html">
         norse.task.correlation_experiment
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../generated/norse.task.mnist.html">
         norse.task.mnist
        </a>
       </li>
      </ul>
     </li>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="../generated/norse.torch.html">
       norse.torch
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/>
      <label for="toctree-checkbox-9">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="../generated/norse.torch.functional.html">
         norse.torch.functional
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../generated/norse.torch.models.html">
         norse.torch.models
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../generated/norse.torch.module.html">
         norse.torch.module
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../generated/norse.torch.utils.html">
         norse.torch.utils
        </a>
       </li>
      </ul>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../generated/norse.utils.html">
       norse.utils
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/norse/norse/HEAD/v2/gh/norse/norse/master?urlpath=tree/docs/pages/parameters.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
      <li>
        <a href="https://colab.research.google.com/github/norse/norse/blob/master/docs/pages/parameters.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Colab"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../_static/images/logo_colab.png">
  </span>
<span class="headerbtn__text-container">Colab</span>
</a>

      </li>
      
      <li>
        
<button onclick="initThebeSBT()"
  class="headerbtn headerbtn-launch-thebe"
  data-toggle="tooltip"
data-placement="left"
title="Launch Thebe"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-play"></i>
  </span>
<span class="headerbtn__text-container">Live Code</span>
</button>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/norse/norse"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/norse/norse/issues/new?title=Issue%20on%20page%20%2Fpages/parameters.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/norse/norse/edit/master/docs/pages/parameters.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Edit this page"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-pencil-alt"></i>
  </span>
<span class="headerbtn__text-container">suggest edit</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../_sources/pages/parameters.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#defining-a-network-of-lif-neurons-with-varying-membrane-time-constants">
   6.1. Defining a Network of LIF Neurons with varying membrane time-constants
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#toy-example-training-a-small-recurrent-snn-on-mnist">
   6.2. Toy Example: Training a small recurrent SNN on MNIST
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dataset-loading">
     6.2.1. Dataset Loading
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#model-defitinition">
     6.2.2. Model Defitinition
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#training-and-test-loop">
     6.2.3. Training and Test loop
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#model-evaluation">
     6.2.4. Model Evaluation
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#conclusions">
   6.3. Conclusions
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Parameter learning in Spiking Neural Networks</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#defining-a-network-of-lif-neurons-with-varying-membrane-time-constants">
   6.1. Defining a Network of LIF Neurons with varying membrane time-constants
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#toy-example-training-a-small-recurrent-snn-on-mnist">
   6.2. Toy Example: Training a small recurrent SNN on MNIST
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dataset-loading">
     6.2.1. Dataset Loading
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#model-defitinition">
     6.2.2. Model Defitinition
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#training-and-test-loop">
     6.2.3. Training and Test loop
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#model-evaluation">
     6.2.4. Model Evaluation
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#conclusions">
   6.3. Conclusions
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="parameter-learning-in-spiking-neural-networks">
<span id="page-parameter-learning"></span><h1><span class="section-number">6. </span>Parameter learning in Spiking Neural Networks<a class="headerlink" href="#parameter-learning-in-spiking-neural-networks" title="Permalink to this headline">#</a></h1>
<p>Author: Christian Pehle</p>
<p>As we have already seen in <a class="reference internal" href="spiking.html#page-spiking"><span class="std std-ref">Introduction to spiking systems</span></a> Neuron models come with parameters, such as membrane time constants, which determine their dynamics. While those parameters are often treated as arbitrarily treated constants and therefore <em>hyperparameters</em> in a machine learning context, more recently it has become clear that it can be benefitial to treat them as <em>parameters</em>. In this notebook, we will first learn how to initialise a network of LIF neurons with distinct, but fixed time constants and voltage thresholds and then how to incorporate them into the optimisation. As we will see, this is largely facilitated by the pre-existing ways of treating parameters in PyTorch.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">torch</span>
<span class="kn">import</span> <span class="nn">norse</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>
</div>
</div>
</div>
<section id="defining-a-network-of-lif-neurons-with-varying-membrane-time-constants">
<h2><span class="section-number">6.1. </span>Defining a Network of LIF Neurons with varying membrane time-constants<a class="headerlink" href="#defining-a-network-of-lif-neurons-with-varying-membrane-time-constants" title="Permalink to this headline">#</a></h2>
<p>A population of recurrently connected LIF neurons can be instantiated in Norse as follows:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">norse.torch.module</span> <span class="kn">import</span> <span class="n">LIFRecurrentCell</span>

<span class="n">m</span> <span class="o">=</span> <span class="n">LIFRecurrentCell</span><span class="p">(</span><span class="n">input_size</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">hidden_size</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="n">m</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LIFRecurrentCell(input_size=200, hidden_size=100, p=LIFParameters(tau_syn_inv=tensor(200.), tau_mem_inv=tensor(100.), v_leak=tensor(0.), v_th=tensor(1.), v_reset=tensor(0.), method=&#39;super&#39;, alpha=tensor(100.)), autapses=False, dt=0.001)
</pre></div>
</div>
</div>
</div>
<p>As you can see the <code class="docutils literal notranslate"><span class="pre">LIFParameters</span></code> are initialised to some default values. It is easy enough to instead sample these values from a given distribution. While we will use a random normal distribution here, a more appropriate choice would be for example a lognormal distribution, as this would guarantee that the inverse membrane time constant remains positive, which is an essential requirement. Here we just choose the standard deviation in such a way, that a negative value would be very unlikely.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">counts</span><span class="p">,</span> <span class="n">bins</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="n">norse</span><span class="o">.</span><span class="n">torch</span><span class="o">.</span><span class="n">functional</span><span class="o">.</span><span class="n">lif</span><span class="o">.</span><span class="n">LIFParameters</span><span class="p">()</span><span class="o">.</span><span class="n">tau_mem_inv</span> <span class="o">+</span> <span class="mi">20</span><span class="o">*</span><span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">100</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">bins</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">bins</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="n">counts</span><span class="p">,</span> <span class="n">histtype</span><span class="o">=</span><span class="s1">&#39;step&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;$</span><span class="se">\\</span><span class="s1">tau_</span><span class="si">{m}</span><span class="s1">^{-1}$ [ms]&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0.5, 0, &#39;$\\tau_{m}^{-1}$ [ms]&#39;)
</pre></div>
</div>
<img alt="../_images/parameters_5_1.png" src="../_images/parameters_5_1.png" />
</div>
</div>
<p>The parameters of a PyTorch module can be accesses by invoking the <code class="docutils literal notranslate"><span class="pre">parameters</span></code> method. In the case of the <code class="docutils literal notranslate"><span class="pre">LIFRecurrentCell</span></code> those are the recurrent and input weight matrices. Note how both tensors have <code class="docutils literal notranslate"><span class="pre">requires_grad=True</span></code> and that the <code class="docutils literal notranslate"><span class="pre">LIFParameters</span></code> do not appear. This is because none of the tensors entering the <code class="docutils literal notranslate"><span class="pre">LIFParameters</span></code> have been registered as a PyTorch Parameter.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">list</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">parameters</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[Parameter containing:
 tensor([[-0.1304, -0.0574,  0.0022,  ..., -0.1830, -0.0919, -0.1367],
         [-0.1173,  0.2009,  0.1719,  ...,  0.0808, -0.1225, -0.0045],
         [-0.1392,  0.0811, -0.0544,  ...,  0.0244,  0.1959,  0.1721],
         ...,
         [ 0.0116, -0.0820,  0.0994,  ...,  0.0135, -0.0685,  0.0024],
         [-0.1136, -0.3065,  0.0924,  ...,  0.0955,  0.0330,  0.3202],
         [-0.0383,  0.0105, -0.1698,  ..., -0.0484,  0.2058, -0.0390]],
        requires_grad=True),
 Parameter containing:
 tensor([[ 0.0000,  0.0785,  0.0254,  ..., -0.1574, -0.1611, -0.1413],
         [ 0.0564,  0.0000, -0.1900,  ..., -0.0309,  0.0818,  0.1970],
         [-0.1260, -0.0295,  0.0000,  ...,  0.0252,  0.0158,  0.0483],
         ...,
         [ 0.0281,  0.1759,  0.1013,  ...,  0.0000,  0.0637,  0.0678],
         [-0.0119, -0.1182, -0.0247,  ...,  0.0748,  0.0000, -0.1360],
         [ 0.1249, -0.1008, -0.1653,  ..., -0.1932,  0.2383,  0.0000]],
        requires_grad=True)]
</pre></div>
</div>
</div>
</div>
<p>The easiest way to rectify this situation is to define an additional <code class="docutils literal notranslate"><span class="pre">torch.nn.Module</span></code> and explicitely register the inverse membrane time constant and threshold as a parameter.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">ParametrizedLIFRecurrentCell</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">input_size</span><span class="p">,</span> <span class="n">hidden_size</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">ParametrizedLIFRecurrentCell</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tau_mem_inv</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Parameter</span><span class="p">(</span><span class="n">norse</span><span class="o">.</span><span class="n">torch</span><span class="o">.</span><span class="n">functional</span><span class="o">.</span><span class="n">lif</span><span class="o">.</span><span class="n">LIFParameters</span><span class="p">()</span><span class="o">.</span><span class="n">tau_mem_inv</span> <span class="o">+</span> <span class="mi">20</span><span class="o">*</span><span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">hidden_size</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">v_th</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Parameter</span><span class="p">(</span><span class="mf">0.5</span> <span class="o">+</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">hidden_size</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cell</span> <span class="o">=</span> <span class="n">norse</span><span class="o">.</span><span class="n">torch</span><span class="o">.</span><span class="n">module</span><span class="o">.</span><span class="n">LIFRecurrentCell</span><span class="p">(</span><span class="n">input_size</span><span class="o">=</span><span class="n">input_size</span><span class="p">,</span> <span class="n">hidden_size</span><span class="o">=</span><span class="n">hidden_size</span><span class="p">,</span> 
                                                        <span class="n">p</span> <span class="o">=</span> <span class="n">norse</span><span class="o">.</span><span class="n">torch</span><span class="o">.</span><span class="n">functional</span><span class="o">.</span><span class="n">lif</span><span class="o">.</span><span class="n">LIFParameters</span><span class="p">(</span>
                                                            <span class="n">tau_mem_inv</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tau_mem_inv</span><span class="p">,</span>
                                                            <span class="n">v_th</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">v_th</span><span class="p">,</span>
                                                            <span class="n">alpha</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span>
                                                        <span class="p">)</span>
                                                        
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m</span> <span class="o">=</span> <span class="n">ParametrizedLIFRecurrentCell</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">m</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ParametrizedLIFRecurrentCell(
  (cell): LIFRecurrentCell(
    input_size=200, hidden_size=100, p=LIFParameters(tau_syn_inv=tensor(200.), tau_mem_inv=Parameter containing:
    tensor([ 75.7920,  91.4721, 100.6811,  93.3940,  48.1718, 155.8346, 105.4945,
             93.9917, 103.6793, 104.0993, 107.4597,  99.4618, 116.2828,  76.6376,
             78.2561,  80.6353,  75.6888, 113.4573,  82.2183,  90.3144,  75.2819,
            122.1725, 106.7111, 135.7841, 140.7492, 105.7754, 101.1402,  75.3224,
             88.5925,  34.8194,  46.6237, 129.8657, 149.0039,  69.1323, 100.4607,
             86.5680, 100.1431,  77.0440,  93.7586, 107.7161, 107.7340, 119.0432,
             94.8909,  86.2967,  91.8577, 119.5163,  91.1072, 114.7594, 114.8846,
            133.6842, 103.1453,  76.5701, 110.8537,  93.8665,  89.7406,  92.1065,
             78.2186, 127.5597,  87.0817,  79.5728,  68.3863,  93.4618, 120.1729,
            126.4171,  87.1484,  95.9445,  81.2522, 101.9575,  90.8631, 105.0020,
            113.1533, 100.4073,  99.2473, 108.3675, 115.1403,  90.0135,  87.3134,
             98.1360,  68.1313,  95.4902,  89.1071,  97.9101, 112.0981, 107.8355,
             74.9896, 136.6291,  64.3273,  74.6213,  90.7767,  98.7474,  99.9009,
            110.3372, 124.4213, 110.3519, 104.6333,  97.1415,  73.4539,  96.3719,
            121.7936, 112.2402], requires_grad=True), v_leak=tensor(0.), v_th=Parameter containing:
    tensor([0.6204, 0.4400, 0.4543, 0.6093, 0.5105, 0.4548, 0.5704, 0.4187, 0.6751,
            0.5077, 0.5854, 0.5124, 0.6546, 0.3679, 0.1895, 0.7049, 0.5466, 0.6603,
            0.5662, 0.4393, 0.6458, 0.4459, 0.5612, 0.5052, 0.4255, 0.4623, 0.5056,
            0.4904, 0.4445, 0.5830, 0.4440, 0.4761, 0.5169, 0.3858, 0.5699, 0.3863,
            0.4363, 0.4996, 0.6152, 0.4497, 0.6391, 0.4658, 0.4128, 0.4131, 0.7222,
            0.3754, 0.6213, 0.5889, 0.5633, 0.4080, 0.5207, 0.6459, 0.3788, 0.6098,
            0.5239, 0.3445, 0.4158, 0.5145, 0.4563, 0.4274, 0.5545, 0.5306, 0.4784,
            0.5145, 0.5114, 0.4523, 0.4514, 0.6151, 0.4321, 0.4356, 0.3197, 0.5228,
            0.3888, 0.5146, 0.4546, 0.4734, 0.3980, 0.5589, 0.5357, 0.5162, 0.3934,
            0.4931, 0.5733, 0.6061, 0.4562, 0.6893, 0.5207, 0.4092, 0.6696, 0.4973,
            0.3785, 0.4806, 0.5313, 0.4329, 0.5631, 0.6454, 0.5448, 0.5342, 0.5610,
            0.6868], requires_grad=True), v_reset=tensor(0.), method=&#39;super&#39;, alpha=tensor(100)), autapses=False, dt=0.001
  )
)
</pre></div>
</div>
</div>
</div>
<p>The inverse membrane time constant and the threshold value now also appears as parameters:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">list</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">parameters</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[Parameter containing:
 tensor([ 75.7920,  91.4721, 100.6811,  93.3940,  48.1718, 155.8346, 105.4945,
          93.9917, 103.6793, 104.0993, 107.4597,  99.4618, 116.2828,  76.6376,
          78.2561,  80.6353,  75.6888, 113.4573,  82.2183,  90.3144,  75.2819,
         122.1725, 106.7111, 135.7841, 140.7492, 105.7754, 101.1402,  75.3224,
          88.5925,  34.8194,  46.6237, 129.8657, 149.0039,  69.1323, 100.4607,
          86.5680, 100.1431,  77.0440,  93.7586, 107.7161, 107.7340, 119.0432,
          94.8909,  86.2967,  91.8577, 119.5163,  91.1072, 114.7594, 114.8846,
         133.6842, 103.1453,  76.5701, 110.8537,  93.8665,  89.7406,  92.1065,
          78.2186, 127.5597,  87.0817,  79.5728,  68.3863,  93.4618, 120.1729,
         126.4171,  87.1484,  95.9445,  81.2522, 101.9575,  90.8631, 105.0020,
         113.1533, 100.4073,  99.2473, 108.3675, 115.1403,  90.0135,  87.3134,
          98.1360,  68.1313,  95.4902,  89.1071,  97.9101, 112.0981, 107.8355,
          74.9896, 136.6291,  64.3273,  74.6213,  90.7767,  98.7474,  99.9009,
         110.3372, 124.4213, 110.3519, 104.6333,  97.1415,  73.4539,  96.3719,
         121.7936, 112.2402], requires_grad=True),
 Parameter containing:
 tensor([0.6204, 0.4400, 0.4543, 0.6093, 0.5105, 0.4548, 0.5704, 0.4187, 0.6751,
         0.5077, 0.5854, 0.5124, 0.6546, 0.3679, 0.1895, 0.7049, 0.5466, 0.6603,
         0.5662, 0.4393, 0.6458, 0.4459, 0.5612, 0.5052, 0.4255, 0.4623, 0.5056,
         0.4904, 0.4445, 0.5830, 0.4440, 0.4761, 0.5169, 0.3858, 0.5699, 0.3863,
         0.4363, 0.4996, 0.6152, 0.4497, 0.6391, 0.4658, 0.4128, 0.4131, 0.7222,
         0.3754, 0.6213, 0.5889, 0.5633, 0.4080, 0.5207, 0.6459, 0.3788, 0.6098,
         0.5239, 0.3445, 0.4158, 0.5145, 0.4563, 0.4274, 0.5545, 0.5306, 0.4784,
         0.5145, 0.5114, 0.4523, 0.4514, 0.6151, 0.4321, 0.4356, 0.3197, 0.5228,
         0.3888, 0.5146, 0.4546, 0.4734, 0.3980, 0.5589, 0.5357, 0.5162, 0.3934,
         0.4931, 0.5733, 0.6061, 0.4562, 0.6893, 0.5207, 0.4092, 0.6696, 0.4973,
         0.3785, 0.4806, 0.5313, 0.4329, 0.5631, 0.6454, 0.5448, 0.5342, 0.5610,
         0.6868], requires_grad=True),
 Parameter containing:
 tensor([[-0.1184,  0.0106, -0.0537,  ..., -0.1958,  0.1343, -0.0761],
         [ 0.1115, -0.2418,  0.0250,  ...,  0.0408, -0.1579, -0.2852],
         [ 0.3311,  0.0771,  0.0993,  ..., -0.0540,  0.0741,  0.0260],
         ...,
         [-0.2122,  0.0502, -0.1024,  ...,  0.1532,  0.1146, -0.0560],
         [-0.2266,  0.0237, -0.2169,  ...,  0.0122, -0.0256, -0.0039],
         [-0.2203,  0.0780,  0.1692,  ..., -0.1150, -0.1232, -0.1215]],
        requires_grad=True),
 Parameter containing:
 tensor([[ 0.0000, -0.0845, -0.0670,  ...,  0.1847, -0.0263,  0.0101],
         [ 0.1065,  0.0000,  0.1868,  ..., -0.0494, -0.1245,  0.2459],
         [-0.0630,  0.1578,  0.0000,  ...,  0.2464,  0.0109,  0.0960],
         ...,
         [ 0.0259,  0.2071,  0.0201,  ...,  0.0000,  0.1527,  0.1154],
         [ 0.2401,  0.0098,  0.2258,  ...,  0.0845,  0.0000, -0.1116],
         [-0.0613, -0.1879, -0.0673,  ..., -0.1303, -0.1605,  0.0000]],
        requires_grad=True)]
</pre></div>
</div>
</div>
</div>
</section>
<section id="toy-example-training-a-small-recurrent-snn-on-mnist">
<h2><span class="section-number">6.2. </span>Toy Example: Training a small recurrent SNN on MNIST<a class="headerlink" href="#toy-example-training-a-small-recurrent-snn-on-mnist" title="Permalink to this headline">#</a></h2>
<p>In order to demonstrate training on an example task, we turn to MNIST. The training and testing code here is adopted from  the training notebook on MNIST and serves as an illustration. We do not necessarily expect there to be a great benefit in optimising the time-constants and threshold in this example.</p>
<section id="dataset-loading">
<h3><span class="section-number">6.2.1. </span>Dataset Loading<a class="headerlink" href="#dataset-loading" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">torchvision</span>

<span class="n">BATCH_SIZE</span> <span class="o">=</span> <span class="mi">256</span>

<span class="n">transform</span> <span class="o">=</span> <span class="n">torchvision</span><span class="o">.</span><span class="n">transforms</span><span class="o">.</span><span class="n">Compose</span><span class="p">(</span>
    <span class="p">[</span>
        <span class="n">torchvision</span><span class="o">.</span><span class="n">transforms</span><span class="o">.</span><span class="n">ToTensor</span><span class="p">(),</span>
        <span class="n">torchvision</span><span class="o">.</span><span class="n">transforms</span><span class="o">.</span><span class="n">Normalize</span><span class="p">((</span><span class="mf">0.1307</span><span class="p">,),</span> <span class="p">(</span><span class="mf">0.3081</span><span class="p">,)),</span>
    <span class="p">]</span>
<span class="p">)</span>

<span class="n">train_data</span> <span class="o">=</span> <span class="n">torchvision</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">MNIST</span><span class="p">(</span>
    <span class="n">root</span><span class="o">=</span><span class="s2">&quot;.&quot;</span><span class="p">,</span>
    <span class="n">train</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">download</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">transform</span><span class="o">=</span><span class="n">transform</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">train_loader</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">DataLoader</span><span class="p">(</span>
    <span class="n">train_data</span><span class="p">,</span>
    <span class="n">batch_size</span><span class="o">=</span><span class="n">BATCH_SIZE</span><span class="p">,</span>
    <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>

<span class="n">test_loader</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">DataLoader</span><span class="p">(</span>
    <span class="n">torchvision</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">MNIST</span><span class="p">(</span>
        <span class="n">root</span><span class="o">=</span><span class="s2">&quot;.&quot;</span><span class="p">,</span>
        <span class="n">train</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">transform</span><span class="o">=</span><span class="n">transform</span><span class="p">,</span>
    <span class="p">),</span>
    <span class="n">batch_size</span><span class="o">=</span><span class="n">BATCH_SIZE</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.3%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.7%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1.0%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1.3%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1.7%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2.0%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2.3%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2.6%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3.0%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3.3%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3.6%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>4.0%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>4.3%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>4.6%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>5.0%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>5.3%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>5.6%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>6.0%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>6.3%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>6.6%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>6.9%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>7.3%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>7.6%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>7.9%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>8.3%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>8.6%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>8.9%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>9.3%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>9.6%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>9.9%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>10.2%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>10.6%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>10.9%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>11.2%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>11.6%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>11.9%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>12.2%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>12.6%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>12.9%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>13.2%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>13.6%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>13.9%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>14.2%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>14.5%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>14.9%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>15.2%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>15.5%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>15.9%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>16.2%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>16.5%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>16.9%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>17.2%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>17.5%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>17.9%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>18.2%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>18.5%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>18.8%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>19.2%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>19.5%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>19.8%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>20.2%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>20.5%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>20.8%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>21.2%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>21.5%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>21.8%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>22.1%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>22.5%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>22.8%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>23.1%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>23.5%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>23.8%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>24.1%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>24.5%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>24.8%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>25.1%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>25.5%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>25.8%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>26.1%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>26.4%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>26.8%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>27.1%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>27.4%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>27.8%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>28.1%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>28.4%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>28.8%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>29.1%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>29.4%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>29.8%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>30.1%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>30.4%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>30.7%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>31.1%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>31.4%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>31.7%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>32.1%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>32.4%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>32.7%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>33.1%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>33.4%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>33.7%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>34.0%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>34.4%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>34.7%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>35.0%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>35.4%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>35.7%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>36.0%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>36.4%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>36.7%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>37.0%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>37.4%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>37.7%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>38.0%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>38.3%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>38.7%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>39.0%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>39.3%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>39.7%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>40.0%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>40.3%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>40.7%
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading http://yann.lecun.com/exdb/mnist/train-images-idx3-ubyte.gz
Downloading http://yann.lecun.com/exdb/mnist/train-images-idx3-ubyte.gz to ./MNIST/raw/train-images-idx3-ubyte.gz
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>41.0%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>41.3%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>41.7%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>42.0%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>42.3%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>42.6%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>43.0%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>43.3%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>43.6%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>44.0%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>44.3%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>44.6%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>45.0%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>45.3%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>45.6%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>45.9%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>46.3%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>46.6%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>46.9%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>47.3%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>47.6%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>47.9%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>48.3%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>48.6%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>48.9%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>49.3%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>49.6%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>49.9%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>50.2%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>50.6%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>50.9%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>51.2%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>51.6%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>51.9%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>52.2%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>52.6%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>52.9%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>53.2%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>53.6%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>53.9%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>54.2%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>54.5%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>54.9%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>55.2%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>55.5%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>55.9%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>56.2%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>56.5%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>56.9%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>57.2%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>57.5%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>57.9%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>58.2%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>58.5%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>58.8%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>59.2%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>59.5%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>59.8%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>60.2%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>60.5%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>60.8%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>61.2%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>61.5%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>61.8%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>62.1%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>62.5%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>62.8%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>63.1%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>63.5%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>63.8%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>64.1%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>64.5%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>64.8%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>65.1%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>65.5%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>65.8%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>66.1%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>66.4%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>66.8%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>67.1%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>67.4%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>67.8%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>68.1%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>68.4%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>68.8%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>69.1%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>69.4%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>69.8%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>70.1%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>70.4%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>70.7%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>71.1%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>71.4%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>71.7%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>72.1%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>72.4%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>72.7%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>73.1%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>73.4%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>73.7%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>74.0%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>74.4%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>74.7%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>75.0%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>75.4%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>75.7%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>76.0%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>76.4%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>76.7%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>77.0%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>77.4%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>77.7%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>78.0%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>78.3%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>78.7%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>79.0%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>79.3%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>79.7%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>80.0%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>80.3%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>80.7%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>81.0%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>81.3%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>81.7%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>82.0%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>82.3%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>82.6%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>83.0%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>83.3%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>83.6%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>84.0%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>84.3%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>84.6%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>85.0%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>85.3%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>85.6%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>85.9%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>86.3%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>86.6%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>86.9%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>87.3%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>87.6%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>87.9%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>88.3%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>88.6%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>88.9%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>89.3%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>89.6%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>89.9%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>90.2%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>90.6%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>90.9%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>91.2%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>91.6%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>91.9%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>92.2%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>92.6%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>92.9%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>93.2%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>93.6%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>93.9%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>94.2%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>94.5%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>94.9%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>95.2%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>95.5%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>95.9%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>96.2%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>96.5%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>96.9%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>97.2%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>97.5%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>97.9%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>98.2%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>98.5%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>98.8%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>99.2%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>99.5%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>99.8%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>100.0%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Extracting ./MNIST/raw/train-images-idx3-ubyte.gz to ./MNIST/raw
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>100.0%
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading http://yann.lecun.com/exdb/mnist/train-labels-idx1-ubyte.gz
Downloading http://yann.lecun.com/exdb/mnist/train-labels-idx1-ubyte.gz to ./MNIST/raw/train-labels-idx1-ubyte.gz
Extracting ./MNIST/raw/train-labels-idx1-ubyte.gz to ./MNIST/raw

Downloading http://yann.lecun.com/exdb/mnist/t10k-images-idx3-ubyte.gz
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2.0%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>4.0%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>6.0%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>7.9%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>9.9%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>11.9%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>13.9%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>15.9%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>17.9%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>19.9%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>21.9%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>23.8%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>25.8%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>27.8%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>29.8%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>31.8%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>33.8%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>35.8%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>37.8%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>39.7%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>41.7%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>43.7%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>45.7%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>47.7%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>49.7%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>51.7%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>53.7%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>55.6%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>57.6%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>59.6%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>61.6%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>63.6%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>65.6%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>67.6%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>69.6%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>71.5%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>73.5%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>75.5%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>77.5%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>79.5%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>81.5%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>83.5%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>85.5%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>87.4%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>89.4%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>91.4%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>93.4%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>95.4%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>97.4%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>99.4%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>100.0%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>100.0%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading http://yann.lecun.com/exdb/mnist/t10k-images-idx3-ubyte.gz to ./MNIST/raw/t10k-images-idx3-ubyte.gz
Extracting ./MNIST/raw/t10k-images-idx3-ubyte.gz to ./MNIST/raw

Downloading http://yann.lecun.com/exdb/mnist/t10k-labels-idx1-ubyte.gz
Downloading http://yann.lecun.com/exdb/mnist/t10k-labels-idx1-ubyte.gz to ./MNIST/raw/t10k-labels-idx1-ubyte.gz
Extracting ./MNIST/raw/t10k-labels-idx1-ubyte.gz to ./MNIST/raw
</pre></div>
</div>
</div>
</div>
</section>
<section id="model-defitinition">
<h3><span class="section-number">6.2.2. </span>Model Defitinition<a class="headerlink" href="#model-defitinition" title="Permalink to this headline">#</a></h3>
<p>For simplicity we are considering a simple network with a single hidden layer of recurrently connected neurons.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">norse.torch</span> <span class="kn">import</span> <span class="n">LICell</span>

<span class="k">class</span> <span class="nc">SNN</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> 
                 <span class="n">input_features</span><span class="p">,</span>
                 <span class="n">hidden_features</span><span class="p">,</span> 
                 <span class="n">output_features</span><span class="p">,</span>
                 <span class="n">recurrent_cell</span>
                <span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">SNN</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cell</span> <span class="o">=</span> <span class="n">recurrent_cell</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fc_out</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="n">hidden_features</span><span class="p">,</span> <span class="n">output_features</span><span class="p">,</span> <span class="n">bias</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">out</span> <span class="o">=</span> <span class="n">LICell</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">input_features</span> <span class="o">=</span> <span class="n">input_features</span>
                             
    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="n">seq_length</span><span class="p">,</span> <span class="n">batch_size</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">shape</span>
        <span class="n">s1</span> <span class="o">=</span> <span class="n">so</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">voltages</span> <span class="o">=</span> <span class="p">[]</span>


        <span class="k">for</span> <span class="n">ts</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">seq_length</span><span class="p">):</span>
            <span class="n">z</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">ts</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:,</span> <span class="p">:]</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">input_features</span><span class="p">)</span>
            <span class="n">z</span><span class="p">,</span> <span class="n">s1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">s1</span><span class="p">)</span>
            <span class="n">z</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fc_out</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
            <span class="n">vo</span><span class="p">,</span> <span class="n">so</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">out</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">so</span><span class="p">)</span>
            <span class="n">voltages</span> <span class="o">+=</span> <span class="p">[</span><span class="n">vo</span><span class="p">]</span>
        
        <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">voltages</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Model</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">encoder</span><span class="p">,</span> <span class="n">snn</span><span class="p">,</span> <span class="n">decoder</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Model</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">encoder</span> <span class="o">=</span> <span class="n">encoder</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">snn</span> <span class="o">=</span> <span class="n">snn</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">decoder</span> <span class="o">=</span> <span class="n">decoder</span>

    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">encoder</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">snn</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="n">log_p_y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decoder</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">log_p_y</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="training-and-test-loop">
<h3><span class="section-number">6.2.3. </span>Training and Test loop<a class="headerlink" href="#training-and-test-loop" title="Permalink to this headline">#</a></h3>
<p>Both the training and test loop are independent of the model or dataset that we are using, in practice you should however probably use a more sophisticated version as they dont take care of parameter checkpoints or other concerns.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">tqdm.notebook</span> <span class="kn">import</span> <span class="n">tqdm</span><span class="p">,</span> <span class="n">trange</span>

<span class="k">def</span> <span class="nf">train</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">device</span><span class="p">,</span> <span class="n">train_loader</span><span class="p">,</span> <span class="n">optimizer</span><span class="p">,</span> <span class="n">epoch</span><span class="p">,</span> <span class="n">max_epochs</span><span class="p">):</span>
    <span class="n">model</span><span class="o">.</span><span class="n">train</span><span class="p">()</span>
    <span class="n">losses</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">target</span><span class="p">)</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">train_loader</span><span class="p">,</span> <span class="n">leave</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="n">data</span><span class="p">,</span> <span class="n">target</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">),</span> <span class="n">target</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
        <span class="n">optimizer</span><span class="o">.</span><span class="n">zero_grad</span><span class="p">()</span>
        <span class="n">output</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="n">loss</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">functional</span><span class="o">.</span><span class="n">nll_loss</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="n">target</span><span class="p">)</span>
        <span class="n">loss</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>
        <span class="n">optimizer</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>
        <span class="n">losses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">loss</span><span class="o">.</span><span class="n">item</span><span class="p">())</span>

    <span class="n">mean_loss</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">losses</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">losses</span><span class="p">,</span> <span class="n">mean_loss</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ModuleNotFoundError</span><span class="g g-Whitespace">                       </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">11</span><span class="p">],</span> <span class="n">line</span> <span class="mi">1</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="kn">from</span> <span class="nn">tqdm.notebook</span> <span class="kn">import</span> <span class="n">tqdm</span><span class="p">,</span> <span class="n">trange</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="k">def</span> <span class="nf">train</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">device</span><span class="p">,</span> <span class="n">train_loader</span><span class="p">,</span> <span class="n">optimizer</span><span class="p">,</span> <span class="n">epoch</span><span class="p">,</span> <span class="n">max_epochs</span><span class="p">):</span>
<span class="g g-Whitespace">      </span><span class="mi">4</span>     <span class="n">model</span><span class="o">.</span><span class="n">train</span><span class="p">()</span>

<span class="ne">ModuleNotFoundError</span>: No module named &#39;tqdm&#39;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">test</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">device</span><span class="p">,</span> <span class="n">test_loader</span><span class="p">,</span> <span class="n">epoch</span><span class="p">):</span>
    <span class="n">model</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
    <span class="n">test_loss</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">correct</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
        <span class="k">for</span> <span class="n">data</span><span class="p">,</span> <span class="n">target</span> <span class="ow">in</span> <span class="n">test_loader</span><span class="p">:</span>
            <span class="n">data</span><span class="p">,</span> <span class="n">target</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">),</span> <span class="n">target</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
            <span class="n">output</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            <span class="n">test_loss</span> <span class="o">+=</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">functional</span><span class="o">.</span><span class="n">nll_loss</span><span class="p">(</span>
                <span class="n">output</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">reduction</span><span class="o">=</span><span class="s2">&quot;sum&quot;</span>
            <span class="p">)</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>  <span class="c1"># sum up batch loss</span>
            <span class="n">pred</span> <span class="o">=</span> <span class="n">output</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span>
                <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">keepdim</span><span class="o">=</span><span class="kc">True</span>
            <span class="p">)</span>  <span class="c1"># get the index of the max log-probability</span>
            <span class="n">correct</span> <span class="o">+=</span> <span class="n">pred</span><span class="o">.</span><span class="n">eq</span><span class="p">(</span><span class="n">target</span><span class="o">.</span><span class="n">view_as</span><span class="p">(</span><span class="n">pred</span><span class="p">))</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>

    <span class="n">test_loss</span> <span class="o">/=</span> <span class="nb">len</span><span class="p">(</span><span class="n">test_loader</span><span class="o">.</span><span class="n">dataset</span><span class="p">)</span>

    <span class="n">accuracy</span> <span class="o">=</span> <span class="mf">100.0</span> <span class="o">*</span> <span class="n">correct</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">test_loader</span><span class="o">.</span><span class="n">dataset</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">test_loss</span><span class="p">,</span> <span class="n">accuracy</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">norse.torch</span> <span class="kn">import</span> <span class="n">ConstantCurrentLIFEncoder</span>

<span class="k">def</span> <span class="nf">decode</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="n">x</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">log_p_y</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">functional</span><span class="o">.</span><span class="n">log_softmax</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">log_p_y</span>


<span class="n">T</span> <span class="o">=</span> <span class="mi">32</span>
<span class="n">LR</span> <span class="o">=</span> <span class="mf">0.002</span>
<span class="n">INPUT_FEATURES</span> <span class="o">=</span> <span class="mi">28</span><span class="o">*</span><span class="mi">28</span>
<span class="n">HIDDEN_FEATURES</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">OUTPUT_FEATURES</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">EPOCHS</span> <span class="o">=</span> <span class="mi">5</span>

<span class="k">if</span> <span class="n">torch</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">is_available</span><span class="p">():</span>
    <span class="n">DEVICE</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="s2">&quot;cuda&quot;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">DEVICE</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="s2">&quot;cpu&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">run_training</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">optimizer</span><span class="p">,</span> <span class="n">epochs</span> <span class="o">=</span> <span class="n">EPOCHS</span><span class="p">):</span>
    <span class="n">training_losses</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">mean_losses</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">test_losses</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">accuracies</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="n">torch</span><span class="o">.</span><span class="n">autograd</span><span class="o">.</span><span class="n">set_detect_anomaly</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">epoch</span> <span class="ow">in</span> <span class="n">trange</span><span class="p">(</span><span class="n">epochs</span><span class="p">):</span>
        <span class="n">training_loss</span><span class="p">,</span> <span class="n">mean_loss</span> <span class="o">=</span> <span class="n">train</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">DEVICE</span><span class="p">,</span> <span class="n">train_loader</span><span class="p">,</span> <span class="n">optimizer</span><span class="p">,</span> <span class="n">epoch</span><span class="p">,</span> <span class="n">max_epochs</span><span class="o">=</span><span class="n">EPOCHS</span><span class="p">)</span>
        <span class="n">test_loss</span><span class="p">,</span> <span class="n">accuracy</span> <span class="o">=</span> <span class="n">test</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">DEVICE</span><span class="p">,</span> <span class="n">test_loader</span><span class="p">,</span> <span class="n">epoch</span><span class="p">)</span>
        <span class="n">training_losses</span> <span class="o">+=</span> <span class="n">training_loss</span>
        <span class="n">mean_losses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mean_loss</span><span class="p">)</span>
        <span class="n">test_losses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">test_loss</span><span class="p">)</span>
        <span class="n">accuracies</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">accuracy</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;final accuracy: </span><span class="si">{</span><span class="n">accuracies</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">model</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="model-evaluation">
<h3><span class="section-number">6.2.4. </span>Model Evaluation<a class="headerlink" href="#model-evaluation" title="Permalink to this headline">#</a></h3>
<p>With all of this boilerplate out of the way we can define our final model and run training for a number of epochs (10 by default). If you are impatient you can decrease that number to 1-2. With the default values, the result will be a test accuracy of &gt;95%, that is nothing to write home about.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">Model</span><span class="p">(</span>
    <span class="n">encoder</span><span class="o">=</span><span class="n">ConstantCurrentLIFEncoder</span><span class="p">(</span>
      <span class="n">seq_length</span><span class="o">=</span><span class="n">T</span><span class="p">,</span>
    <span class="p">),</span>
    <span class="n">snn</span><span class="o">=</span><span class="n">SNN</span><span class="p">(</span>
      <span class="n">input_features</span><span class="o">=</span><span class="n">INPUT_FEATURES</span><span class="p">,</span>
      <span class="n">hidden_features</span><span class="o">=</span><span class="n">HIDDEN_FEATURES</span><span class="p">,</span>
      <span class="n">output_features</span><span class="o">=</span><span class="n">OUTPUT_FEATURES</span><span class="p">,</span>
      <span class="n">recurrent_cell</span><span class="o">=</span><span class="n">ParametrizedLIFRecurrentCell</span><span class="p">(</span>
            <span class="n">input_size</span><span class="o">=</span><span class="mi">28</span><span class="o">*</span><span class="mi">28</span><span class="p">,</span> 
            <span class="n">hidden_size</span><span class="o">=</span><span class="mi">100</span>
      <span class="p">)</span>
    <span class="p">),</span>
    <span class="n">decoder</span><span class="o">=</span><span class="n">decode</span>
<span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">DEVICE</span><span class="p">)</span>

<span class="n">optimizer</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">optim</span><span class="o">.</span><span class="n">Adam</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="p">(),</span> <span class="n">lr</span><span class="o">=</span><span class="n">LR</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tau_mem_inv_before</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">snn</span><span class="o">.</span><span class="n">cell</span><span class="o">.</span><span class="n">cell</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">tau_mem_inv</span><span class="o">.</span><span class="n">cpu</span><span class="p">()</span><span class="o">.</span><span class="n">detach</span><span class="p">()</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span>
<span class="n">v_th_before</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">snn</span><span class="o">.</span><span class="n">cell</span><span class="o">.</span><span class="n">cell</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">v_th</span><span class="o">.</span><span class="n">cpu</span><span class="p">()</span><span class="o">.</span><span class="n">detach</span><span class="p">()</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model_after</span> <span class="o">=</span> <span class="n">run_training</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">optimizer</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id": "c40af3ede50643159ee27af2a3f3fcf2", "version_major": 2, "version_minor": 0}
</script><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "", "version_major": 2, "version_minor": 0}
</script><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "", "version_major": 2, "version_minor": 0}
</script><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "", "version_major": 2, "version_minor": 0}
</script><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "", "version_major": 2, "version_minor": 0}
</script><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "", "version_major": 2, "version_minor": 0}
</script><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "", "version_major": 2, "version_minor": 0}
</script><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "", "version_major": 2, "version_minor": 0}
</script><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "", "version_major": 2, "version_minor": 0}
</script><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "", "version_major": 2, "version_minor": 0}
</script><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "", "version_major": 2, "version_minor": 0}
</script><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>final accuracy: 95.94
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tau_mem_inv_after</span> <span class="o">=</span> <span class="n">model_after</span><span class="o">.</span><span class="n">snn</span><span class="o">.</span><span class="n">cell</span><span class="o">.</span><span class="n">cell</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">tau_mem_inv</span><span class="o">.</span><span class="n">cpu</span><span class="p">()</span><span class="o">.</span><span class="n">detach</span><span class="p">()</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span>
<span class="n">v_th_after</span> <span class="o">=</span> <span class="n">model_after</span><span class="o">.</span><span class="n">snn</span><span class="o">.</span><span class="n">cell</span><span class="o">.</span><span class="n">cell</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">v_th</span><span class="o">.</span><span class="n">cpu</span><span class="p">()</span><span class="o">.</span><span class="n">detach</span><span class="p">()</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>We can plot the distribution of inverse membrane timeconstants before and after the training:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">counts</span><span class="p">,</span> <span class="n">bins</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="n">tau_mem_inv_before</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">bins</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">bins</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="n">counts</span><span class="p">,</span> <span class="n">histtype</span><span class="o">=</span><span class="s1">&#39;step&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;before&#39;</span><span class="p">)</span>
<span class="n">counts</span><span class="p">,</span> <span class="n">bins</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="n">tau_mem_inv_after</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">bins</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">bins</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="n">counts</span><span class="p">,</span> <span class="n">histtype</span><span class="o">=</span><span class="s1">&#39;step&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;after&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$</span><span class="se">\\</span><span class="s1">tau_</span><span class="si">{m}</span><span class="s1">^{-1}$ [ms]&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.legend.Legend at 0x7fe665b8efd0&gt;
</pre></div>
</div>
<img alt="../_images/parameters_30_1.png" src="../_images/parameters_30_1.png" />
</div>
</div>
<p>Similarly we can plot the distribution of membrane threshold voltages before and after optimisation:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">counts</span><span class="p">,</span> <span class="n">bins</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="n">v_th_before</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">bins</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">bins</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="n">counts</span><span class="p">,</span> <span class="n">histtype</span><span class="o">=</span><span class="s1">&#39;step&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;before&#39;</span><span class="p">)</span>
<span class="n">counts</span><span class="p">,</span> <span class="n">bins</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="n">v_th_after</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">bins</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">bins</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="n">counts</span><span class="p">,</span> <span class="n">histtype</span><span class="o">=</span><span class="s1">&#39;step&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;after&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$v_</span><span class="si">{th}</span><span class="s1">$ [a.u.]&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.legend.Legend at 0x7fe665b8a8e0&gt;
</pre></div>
</div>
<img alt="../_images/parameters_32_1.png" src="../_images/parameters_32_1.png" />
</div>
</div>
</section>
</section>
<section id="conclusions">
<h2><span class="section-number">6.3. </span>Conclusions<a class="headerlink" href="#conclusions" title="Permalink to this headline">#</a></h2>
<p>This concludes this tutorial, as we have seen incorporating <em>neuron parameters</em> into the optimisation in Norse mainly requires knowledge of the PyTorch internals. At the moment that optimisation is also only supported for the surrogate gradient implementation and not while using the discretised adjoint implementation. This is not a fundamental limitation though and support for neuron parameter gradients could be added.</p>
<p>Several publications have recently explored optimising neuron parameters to both demonstrate that the resulting time constant distributions more closely resembled ones measured in biological cells and advantages in ML applications. As always the challenge to practically demonstrating the advantage of incorporating neuron parameters into the optimisation is doing careful and controlled experiments and choosing the right tasks. While this notebook demonstrates the general technique it does take some shortcuts:</p>
<ul class="simple">
<li><p>Optimisation works best if the scale of the values to be optimised is in an appropriate range. This is not the case here for the inverse time constant, which has a value of &gt; 100. A more sophisticated approach would take this into account by for example generating this parameter from an appropriately scaled initial value.</p></li>
<li><p>Similarly we have chosen a rather naive initialisation of both the threshold and inverse membrane time constant. More careful initialisation would for example involve sampling from a distribution with guaranteed positive samples.</p></li>
<li><p>Finally we havent demonstrated any benefit of jointly optimising neuron parameters and synaptic weights.</p></li>
</ul>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "norse/norse",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./pages"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="tasks.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title"><span class="section-number">5. </span>Running Tasks</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="hardware.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">7. </span>Hardware acceleration</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Norse.ai<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>